# CloudFuze Chatbot Test Suite - 15 Core Test Cases
# Tests via HTTP API: http://localhost:8002/api/chat

# ==============================================================================
# CATEGORY 1: CORE BUSINESS QUESTIONS (3 tests)
# ==============================================================================

- description: "Business: What is CloudFuze?"
  vars:
    question: "What is CloudFuze?"
  assert:
    - type: contains
      value: "CloudFuze"
    - type: contains-any
      value: ["migration", "cloud", "data"]
    - type: not-contains
      value: "I don't have"
    - type: javascript
      value: "output.length > 100"  # Substantial response
    - type: llm-rubric
      value: |
        The response should:
        - Clearly explain what CloudFuze is
        - Mention cloud migration or data transfer
        - Be informative and professional
        Score 1-10 based on clarity and completeness.
      threshold: 0.7

- description: "Business: What does CloudFuze do?"
  vars:
    question: "What does CloudFuze do?"
  assert:
    - type: contains
      value: "CloudFuze"
    - type: contains-any
      value: ["migrate", "migration", "transfer", "cloud"]
    - type: javascript
      value: "output.length > 80"
    - type: llm-rubric
      value: "Should describe CloudFuze services and capabilities accurately"
      threshold: 0.7

- description: "Business: Pricing inquiry"
  vars:
    question: "How much does CloudFuze cost?"
  assert:
    - type: contains-any
      value: ["pricing", "contact", "sales", "www.cloudfuze.com"]
    - type: regex
      value: "https://www\\.cloudfuze\\.com"
    - type: llm-rubric
      value: "Should provide pricing page link or contact information"
      threshold: 0.7

# ==============================================================================
# CATEGORY 2: HIGH-VALUE MIGRATIONS (5 tests)
# ==============================================================================

- description: "Migration: Slack to Teams"
  vars:
    question: "How do I migrate from Slack to Microsoft Teams?"
  assert:
    - type: contains-all
      value: ["Slack", "Teams"]
    - type: contains-any
      value: ["migration", "migrate", "transfer"]
    - type: not-contains
      value: "I don't have access"
    - type: regex
      value: "https://www\\.cloudfuze\\.com/slack-to-teams"
    - type: llm-rubric
      value: |
        The response should:
        - Explain the Slack to Teams migration process
        - Mention key features or steps
        - Include relevant CloudFuze links
        - Not hallucinate unsupported features
      threshold: 0.75

- description: "Migration: Gmail to Outlook"
  vars:
    question: "Gmail to Outlook migration"
  assert:
    - type: contains-any
      value: ["Gmail", "Outlook", "email", "migration"]
    - type: not-contains
      value: "I'm sorry, I don't"
    - type: llm-rubric
      value: "Should discuss email migration between Gmail and Outlook"
      threshold: 0.6

- description: "Migration: Teams to Teams"
  vars:
    question: "Teams to teams migration"
  assert:
    - type: contains
      value: "Teams"
    - type: contains-any
      value: ["migration", "migrate", "transfer"]
    - type: regex
      value: "https://www\\.cloudfuze\\.com/teams-to-teams"
    - type: llm-rubric
      value: "Should explain Teams to Teams migration capabilities"
      threshold: 0.7

- description: "Migration: Box to SharePoint"
  vars:
    question: "How do I migrate from Box to SharePoint?"
  assert:
    - type: contains-all
      value: ["Box", "SharePoint"]
    - type: contains-any
      value: ["migration", "migrate"]
    - type: javascript
      value: "output.length > 100"
    - type: llm-rubric
      value: "Should provide guidance on Box to SharePoint migration"
      threshold: 0.7

- description: "Migration: Google Drive to SharePoint"
  vars:
    question: "Google Drive to SharePoint"
  assert:
    - type: contains-any
      value: ["Google Drive", "SharePoint", "migration"]
    - type: not-contains
      value: "don't know"
    - type: llm-rubric
      value: "Should discuss Google Drive to SharePoint migration"
      threshold: 0.6

# ==============================================================================
# CATEGORY 3: CERTIFICATE/DOCUMENT DOWNLOADS (4 tests)
# ==============================================================================

- description: "Download: SOC 2 certificate"
  vars:
    question: "Download SOC 2 certificate"
  assert:
    - type: contains
      value: "certificate"
    - type: contains-any
      value: ["SOC", "download", "Download"]
    # Check for markdown download link format
    - type: regex
      value: "\\[.*[Dd]ownload.*\\]\\(https?://.*\\)"
    - type: llm-rubric
      value: |
        The response should:
        - Provide a download link for the SOC 2 certificate
        - Use proper markdown link format
        - Not just mention the certificate without a link
      threshold: 0.7

- description: "Inquiry: Available certificates"
  vars:
    question: "What certificates do you have?"
  assert:
    - type: contains-any
      value: ["certificate", "SOC", "compliance", "security"]
    - type: javascript
      value: "output.length > 50"
    - type: llm-rubric
      value: "Should list available security/compliance certificates"
      threshold: 0.6

- description: "Inquiry: Policy documents"
  vars:
    question: "What policy documents do you have?"
  assert:
    - type: contains-any
      value: ["policy", "document", "security", "compliance"]
    - type: not-contains
      value: "I don't have access"
    - type: llm-rubric
      value: "Should describe available policy documents"
      threshold: 0.6

- description: "Inquiry: Security policies"
  vars:
    question: "Show me security policies"
  assert:
    - type: contains-any
      value: ["security", "policy", "policies"]
    - type: javascript
      value: "output.length > 50"
    - type: llm-rubric
      value: "Should provide information about security policies"
      threshold: 0.6

# ==============================================================================
# CATEGORY 4: REFUSAL BEHAVIOR (3 tests)
# ==============================================================================

- description: "Refusal: Unrelated geography question"
  vars:
    question: "What is the capital of France?"
  assert:
    - type: contains-any
      value: ["don't have", "can't help", "knowledge base", "CloudFuze"]
    - type: not-contains
      value: "Paris"
    - type: llm-rubric
      value: |
        The response should:
        - Politely decline to answer
        - Not provide general knowledge answers
        - Redirect to CloudFuze topics
        - Not mention Paris or France's capital
      threshold: 0.8

- description: "Refusal: Cooking question"
  vars:
    question: "How to cook pasta?"
  assert:
    - type: contains-any
      value: ["don't have", "can't help", "CloudFuze", "knowledge base"]
    - type: not-contains
      value: "boil"
    - type: not-contains
      value: "water"
    - type: llm-rubric
      value: "Should refuse gracefully and redirect to CloudFuze services"
      threshold: 0.8

- description: "Refusal: Weather question"
  vars:
    question: "Tell me about the weather"
  assert:
    - type: contains-any
      value: ["don't have", "can't help", "knowledge base", "CloudFuze"]
    - type: not-contains
      value: "sunny"
    - type: not-contains
      value: "rain"
    - type: llm-rubric
      value: "Should indicate it only handles CloudFuze-related questions"
      threshold: 0.8



